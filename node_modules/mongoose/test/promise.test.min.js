/**
 * Module dependencies.
 */var assert=require("assert"),Promise=require("../lib/promise");describe("promise",function(){it("events fire right after complete()",function(){var e=new Promise,t=0;e.on("complete",function(e,n){assert.equal(e,"1");assert.equal(n,"2");t++});e.complete("1","2");e.on("complete",function(e,n){assert.equal(e,"1");assert.equal(n,"2");t++});assert.equal(2,t)});it("events first right after error()",function(){var e=new Promise,t=0;e.on("err",function(e){assert.ok(e instanceof Error);t++});e.error(new Error("booyah"));e.on("err",function(e){assert.ok(e instanceof Error);t++});assert.equal(2,t)});describe("errback+callback",function(){it("from constructor works",function(){var e=0,t=new Promise(function(t){assert.ok(t instanceof Error);e++});t.error(new Error("dawg"));assert.equal(1,e)});it("after complete()",function(){var e=new Promise,t=0;e.complete("woot");e.addBack(function(e,n){assert.equal(n,"woot");t++});e.addBack(function(e,n){assert.strictEqual(e,null);t++});assert.equal(2,t)});it("after error()",function(){var e=new Promise,t=0;e.error(new Error("woot"));e.addBack(function(e){assert.ok(e instanceof Error);t++});e.addBack(function(e){assert.ok(e instanceof Error);t++});assert.equal(2,t)})});describe("addCallback shortcut",function(){it("works",function(){var e=new Promise,t=0;e.addCallback(function(e){assert.strictEqual(e,undefined);t++});e.complete();assert.equal(1,t)})});describe("addErrback shortcut",function(){var e=new Promise,t=0;e.addErrback(function(e){assert.ok(e instanceof Error);t++});e.error(new Error);assert.equal(1,t)});describe("return values",function(){it("on()",function(){var e=new Promise;assert.ok(e.on("jump",function(){})instanceof Promise)});it("addCallback()",function(){var e=new Promise;assert.ok(e.addCallback(function(){})instanceof Promise)});it("addErrback()",function(){var e=new Promise;assert.ok(e.addErrback(function(){})instanceof Promise)});it("addBack()",function(){var e=new Promise;assert.ok(e.addBack(function(){})instanceof Promise)})})});