var mongoose=require("../"),Schema=mongoose.Schema,db=mongoose.connect("localhost","testing_bench"),DocSchema=new Schema({title:String}),AllSchema=new Schema({string:{type:String,required:!0},number:{type:Number,min:10},date:Date,bool:Boolean,buffer:Buffer,objectid:Schema.ObjectId,array:Array,strings:[String],numbers:[Number],dates:[Date],bools:[Boolean],buffers:[Buffer],objectids:[Schema.ObjectId],docs:{type:[DocSchema],validate:function(){return!0}},s:{nest:String}}),A=mongoose.model("A",AllSchema),methods=[];methods.push(function(e,t){A.findOne({_id:e._id},t)});methods.push(function(e,t){A.find({_id:e._id,bool:e.bool},t)});methods.push(function(e,t){A.findById(e._id,t)});methods.push(function(e,t){A.where("number",e.number).limit(10).exec(t)});methods.push(function(e,t){A.where("date",e.date).select("string").limit(10).exec(t)});methods.push(function(e,t){A.where("date",e.date).select("string bool").limit(10).exec(t)});methods.push(function(e,t){A.where("date",e.date).where("array").in(3).limit(10).exec(t)});methods.push(function(e,t){A.update({_id:e._id},{$addToset:{array:"heeeeello"}},t)});methods.push(function(e,t){A.remove({_id:e._id},t)});methods.push(function(e,t){A.find().where("objectids").exists().select("dates").limit(10).exec(t)});methods.push(function(e,t){A.count({strings:e.strings[2],number:e.number},t)});methods.push(function(e,t){e.string="asdfaf";e.number=38383838;e.date=new Date;e.bool=!1;e.array.push(3);e.dates.push(new Date);e.bools.push([!0,!1]);e.docs.addToSet({title:"woot"});e.strings.remove("three");e.numbers.pull(72);e.objectids.$pop();e.docs.pull.apply(e.docs,e.docs);e.s.nest="aooooooga";i%2?e.toObject({depopulate:!0}):e._delta();t()});var started=process.memoryUsage(),start=new Date,total=1e4,i=total;mongoose.connection.on("open",function(){mongoose.connection.db.dropDatabase(function(){function e(){var e=(new Date-start)/1e3;console.error("took %d seconds for %d docs (%d dps)",e,total,total/e);var t=process.memoryUsage(),n={};n.rss=t.rss-started.rss;n.heapTotal=t.heapTotal-started.heapTotal;n.heapUsed=t.heapUsed-started.heapUsed;console.error("change: ",n);mongoose.connection.db.dropDatabase(function(){mongoose.connection.close()})}(function t(){if(0===i--)return e();var n=new A({string:"hello world",number:444848484,date:new Date,bool:!0,buffer:new Buffer(0),objectid:new mongoose.Types.ObjectId,array:[4,{},[],"asdfa"],strings:["one","two","three","four"],numbers:[72,6493,83984643,348282.55],dates:[new Date,new Date,new Date],bools:[!0,!1,!1,!0,!0],buffers:[new Buffer([33]),new Buffer([12])],objectids:[new mongoose.Types.ObjectId],docs:[{title:"yo"},{title:"nowafasdi0fas asjkdfla fa"}]});n.save(function(e){methods[Math.random()*methods.length|0](n,function(){n=u=null;process.nextTick(t)})});!(i%50)})()})});