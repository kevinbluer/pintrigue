function log(){out&&console.error.apply(console,arguments)}function run(e,t){log("running %s",e);var n=process.memoryUsage(),r=new Date,i=1e4,s=i;while(s--){a=t();s%2?a.toObject({depopulate:!0}):a._delta()}var o=(new Date-r)/1e3;totaltime+=o;numdocs+=i;log(e+" took %d seconds for %d docs (%d dps)",o,i,i/o);var u=process.memoryUsage(),f={};f.rss=u.rss-n.rss;f.heapTotal=u.heapTotal-n.heapTotal;f.heapUsed=u.heapUsed-n.heapUsed;log("change: ",f);a=f=u=o=n=r=i=s=null}Error.stackTraceLimit=Infinity;var out=process.argv.length<3,mongoose=require("../"),Schema=mongoose.Schema,DocSchema=new Schema({title:String}),AllSchema=new Schema({string:String,number:Number,date:Date,bool:Boolean,buffer:Buffer,objectid:Schema.ObjectId,array:Array,strings:[String],numbers:[Number],dates:[Date],bools:[Boolean],buffers:[Buffer],objectids:[Schema.ObjectId],docs:[DocSchema]}),A=mongoose.model("A",AllSchema),numdocs=0,totaltime=0;run("string",function(){return new A({string:"hello world"})});run("number",function(){return new A({number:444848484})});run("date",function(){return new A({date:new Date})});run("bool",function(){return new A({bool:!0})});run("buffer",function(){return new A({buffer:new Buffer(0)})});run("objectid",function(){return new A({objectid:new mongoose.Types.ObjectId})});run("array of mixed",function(){return new A({array:[4,{},[],"asdfa"]})});run("array of strings",function(){return new A({strings:["one","two","three","four"]})});run("array of numbers",function(){return new A({numbers:[72,6493,83984643,348282.55]})});run("array of dates",function(){return new A({dates:[new Date,new Date,new Date]})});run("array of bools",function(){return new A({bools:[!0,!1,!1,!0,!0]})});run("array of buffers",function(){return new A({buffers:[new Buffer([33]),new Buffer([12])]})});run("array of objectids",function(){return new A({objectids:[new mongoose.Types.ObjectId]})});run("array of docs",function(){return new A({docs:[{title:"yo"},{title:"nowafasdi0fas asjkdfla fa"}]})});console.error("completed %d docs in %d seconds (%d dps)",numdocs,totaltime,numdocs/totaltime);