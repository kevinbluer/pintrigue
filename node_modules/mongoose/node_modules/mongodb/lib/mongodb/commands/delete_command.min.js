var BaseCommand=require("./base_command").BaseCommand,inherits=require("util").inherits,DeleteCommand=exports.DeleteCommand=function(e,t,n,r){BaseCommand.call(this);var i=n;if(Buffer.isBuffer(i)){var s=i[0]|i[1]<<8|i[2]<<16|i[3]<<24;if(s!=i.length){var o=new Error("delete raw message size does not match message header size ["+i.length+"] != ["+s+"]");o.name="MongoError";throw o}}this.flags=r;this.collectionName=t;this.selector=n;this.db=e};inherits(DeleteCommand,BaseCommand);DeleteCommand.OP_DELETE=2006;DeleteCommand.prototype.toBinary=function(){var e=4+Buffer.byteLength(this.collectionName)+1+4+this.db.bson.calculateObjectSize(this.selector,!1,!0)+16,t=0,n=new Buffer(e);n[t+3]=e>>24&255;n[t+2]=e>>16&255;n[t+1]=e>>8&255;n[t]=e&255;t+=4;n[t+3]=this.requestId>>24&255;n[t+2]=this.requestId>>16&255;n[t+1]=this.requestId>>8&255;n[t]=this.requestId&255;t+=4;n[t++]=0;n[t++]=0;n[t++]=0;n[t++]=0;n[t+3]=DeleteCommand.OP_DELETE>>24&255;n[t+2]=DeleteCommand.OP_DELETE>>16&255;n[t+1]=DeleteCommand.OP_DELETE>>8&255;n[t]=DeleteCommand.OP_DELETE&255;t+=4;n[t++]=0;n[t++]=0;n[t++]=0;n[t++]=0;t=t+n.write(this.collectionName,t,"utf8")+1;n[t-1]=0;n[t+3]=this.flags>>24&255;n[t+2]=this.flags>>16&255;n[t+1]=this.flags>>8&255;n[t]=this.flags&255;t+=4;var r=0;if(Buffer.isBuffer(this.selector)){r=this.selector.length;this.selector.copy(n,t)}else r=this.db.bson.serializeWithBufferAndIndex(this.selector,this.checkKeys,n,t)-t+1;n[t+3]=r>>24&255;n[t+2]=r>>16&255;n[t+1]=r>>8&255;n[t]=r&255;t+=r;n[t-1]=0;return n};