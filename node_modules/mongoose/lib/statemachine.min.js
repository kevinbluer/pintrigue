/*!
 * Module dependencies.
 */var utils=require("./utils"),StateMachine=module.exports=exports=function(){this.paths={};this.states={}};StateMachine.ctor=function(){var e=utils.args(arguments),t=function(){StateMachine.apply(this,arguments);this.stateNames=e;var t=e.length,n;while(t--){n=e[t];this.states[n]={}}};t.prototype.__proto__=StateMachine.prototype;e.forEach(function(e){t.prototype[e]=function(t){this._changeState(t,e)}});return t};StateMachine.prototype._changeState=function(t,n){var r=this.states[this.paths[t]];r&&delete r[t];this.paths[t]=n;this.states[n][t]=!0};StateMachine.prototype.clear=function(t){var n=Object.keys(this.states[t]),r=n.length,i;while(r--){i=n[r];delete this.states[t][i];delete this.paths[i]}};StateMachine.prototype.some=function(){var t=this,n=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(n,function(e){return Object.keys(t.states[e]).length})};StateMachine.prototype._iter=function(t){return function(){var e=arguments.length,n=utils.args(arguments,0,e-1),r=arguments[e-1];n.length||(n=this.stateNames);var i=this,s=n.reduce(function(e,t){return e.concat(Object.keys(i.states[t]))},[]);return s[t](function(e,t,n){return r(e,t,n)})}};StateMachine.prototype.forEach=function(){this.forEach=this._iter("forEach");return this.forEach.apply(this,arguments)};StateMachine.prototype.map=function(){this.map=this._iter("map");return this.map.apply(this,arguments)};