/*!
 * Module dependencies.
 */function Promise(e){this.emitted={};"function"==typeof e&&this.addBack(e)}var util=require("./utils"),EventEmitter=util.EventEmitter;Promise.prototype.__proto__=EventEmitter.prototype;Promise.prototype.on=function(e,t){this.emitted[e]?t.apply(this,this.emitted[e]):EventEmitter.prototype.on.call(this,e,t);return this};Promise.prototype.emit=function(e){if(e=="err"||e=="complete"){if(this.emitted.err||this.emitted.complete)return this;this.emitted[e]=util.args(arguments,1)}return EventEmitter.prototype.emit.apply(this,arguments)};Promise.prototype.complete=function(){var e=util.args(arguments);return this.emit.apply(this,["complete"].concat(e))};Promise.prototype.error=function(e){e instanceof Error||(e=new Error(e));return this.emit("err",e)};Promise.prototype.addCallback=function(e){return this.on("complete",e)};Promise.prototype.addErrback=function(e){return this.on("err",e)};Promise.prototype.addBack=function(e){this.on("err",function(t){e.call(this,t)});this.on("complete",function(){var t=util.args(arguments);e.apply(this,[null].concat(t))});return this};Promise.prototype.resolve=function(e,t){return e?this.error(e):this.complete(t)};module.exports=Promise;